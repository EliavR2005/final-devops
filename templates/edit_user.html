{% extends "base.html" %}

{% block title %}Editar Usuario - {{ user.username }}{% endblock %}

{% block content %}
<div class="edit-container" style="max-width:600px; margin:auto; padding:1rem;">
  <h1>Editar Usuario: {{ user.username }}</h1>

  <!-- Formulario de edición que pide contraseña antes de guardar -->
  <form method="POST" style="display:grid; gap:1rem;">
    <!-- Verificación de contraseña admin para autorizar cambios -->
    <label>
      Ingresa tu contraseña para confirmar cambios:
      <input type="password" name="admin_password" placeholder="Contraseña admin" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Nombre -->
    <label>
      Nombre:
      <input type="text" name="name" value="{{ user.name }}" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Email -->
    <label>
      Email:
      <input type="email" name="email" value="{{ user.email }}" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Dirección -->
    <label>
      Dirección:
      <input type="text" name="address" value="{{ user.address }}" style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Teléfono -->
    <label>
      Teléfono:
      <input type="tel" name="phone" value="{{ user.phone }}" style="width:100%; padding:0.5rem;" />
    </label>

    <!-- RFC: permitimos editar, no debe quedar vacío -->
    <label>
      RFC:
      <input type="text" name="rfc" value="{{ user.rfc }}" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Fecha de nacimiento y género -->
    <div style="display:flex; gap:1rem;">
      <label style="flex:1">
        Fecha de nacimiento:
        <input type="date" name="birth_date" value="{{ user.birth_date }}" required style="width:100%; padding:0.5rem;" />
      </label>
      <label style="flex:1">
        Género:
        <select name="gender" style="width:100%; padding:0.5rem;">
          <option value="Male" {% if user.gender=='Male' %}selected{% endif %}>Male</option>
          <option value="Female" {% if user.gender=='Female' %}selected{% endif %}>Female</option>
          <option value="Other" {% if user.gender=='Other' %}selected{% endif %}>Other</option>
        </select>
      </label>
    </div>

    <!-- Ocultamos el rol, no mostramos ni permitimos editar -->

    <!-- Botones -->
    <div style="display:flex; gap:1rem; justify-content:flex-end;">
      <a href="{{ url_for('dashboard') }}"><button type="button" style="padding:0.5rem 1rem;">Cancelar</button></a>
      <button type="submit" style="padding:0.5rem 1rem;">Guardar cambios</button>
    </div>
  </form>
</div>

<div id="editFormContainer" style="display:none;">
  <form method="POST" style="display:grid; gap:1rem;">
    <!-- Verificación de contraseña admin para autorizar cambios -->
    <label>
      Ingresa tu contraseña para confirmar cambios:
      <input type="password" name="admin_password" placeholder="Contraseña admin" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Nombre -->
    <label>
      Nombre:
      <input type="text" name="name" value="{{ user.name }}" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Email -->
    <label>
      Email:
      <input type="email" name="email" value="{{ user.email }}" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Dirección -->
    <label>
      Dirección:
      <input type="text" name="address" value="{{ user.address }}" style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Teléfono -->
    <label>
      Teléfono:
      <input type="tel" name="phone" value="{{ user.phone }}" style="width:100%; padding:0.5rem;" />
    </label>

    <!-- RFC -->
    <label>
      RFC:
      <input type="text" name="rfc" value="{{ user.rfc }}" required style="width:100%; padding:0.5rem;" />
    </label>

    <!-- Fecha de nacimiento y género -->
    <div style="display:flex; gap:1rem;">
      <label style="flex:1">
        Fecha de nacimiento:
        <input type="date" name="birth_date" value="{{ user.birth_date }}" required style="width:100%; padding:0.5rem;" />
      </label>
      <label style="flex:1">
        Género:
        <select name="gender" style="width:100%; padding:0.5rem;">
          <option value="Male" {% if user.gender=='Male' %}selected{% endif %}>Male</option>
          <option value="Female" {% if user.gender=='Female' %}selected{% endif %}>Female</option>
          <option value="Other" {% if user.gender=='Other' %}selected{% endif %}>Other</option>
        </select>
      </label>
    </div>

    <!-- Botones -->
    <div style="display:flex; gap:1rem; justify-content:flex-end;">
      <a href="{{ url_for('dashboard') }}"><button type="button" style="padding:0.5rem 1rem;">Cancelar</button></a>
      <button type="submit" style="padding:0.5rem 1rem;">Guardar cambios</button>
    </div>
  </form>
</div>
{% endblock %}